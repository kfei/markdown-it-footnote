!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).markdownitFootnote=e()}}(function(){return function s(f,l,i){function u(o,e){if(!l[o]){if(!f[o]){var n="function"==typeof require&&require;if(!e&&n)return n(o,!0);if(a)return a(o,!0);var t=new Error("Cannot find module '"+o+"'");throw t.code="MODULE_NOT_FOUND",t}var r=l[o]={exports:{}};f[o][0].call(r.exports,function(e){return u(f[o][1][e]||e)},r,r.exports,s,f,l,i)}return l[o].exports}for(var a="function"==typeof require&&require,e=0;e<i.length;e++)u(i[e]);return u}({1:[function(e,o,n){"use strict";function t(e,o,n,t){var r=Number(e[o].meta.id+1).toString(),s="";return"string"==typeof t.docId&&(s="-"+t.docId+"-"),s+r}function r(e,o){return"["+Number(e[o].meta.id+1).toString()+"]"}function s(e,o,n,t,r){var s=r.rules.footnote_anchor_name(e,o,n,t,r),f=r.rules.footnote_caption(e,o,n,t,r),l=s;return 0<e[o].meta.subId&&(l+=":"+e[o].meta.subId),'<sup class="footnote-ref"><a href="#fn'+s+'" id="fnref'+l+'">'+f+"</a></sup>"}function f(e,o,n){return(n.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'}function l(){return"</ol>\n</section>\n"}function u(e,o,n,t,r){var s=r.rules.footnote_anchor_name(e,o,n,t,r);return 0<e[o].meta.subId&&(s+=":"+e[o].meta.subId),'<li id="fn'+s+'" class="footnote-item">'}function a(){return"</li>\n"}function c(e,o,n,t,r){var s=r.rules.footnote_anchor_name(e,o,n,t,r);return 0<e[o].meta.subId&&(s+=":"+e[o].meta.subId),' <a href="#fnref'+s+'" class="footnote-backref">↩︎</a>'}o.exports=function(e){var i=e.helpers.parseLinkLabel,v=e.utils.isSpace;e.renderer.rules.footnote_ref=s,e.renderer.rules.footnote_block_open=f,e.renderer.rules.footnote_block_close=l,e.renderer.rules.footnote_open=u,e.renderer.rules.footnote_close=a,e.renderer.rules.footnote_anchor=c,e.renderer.rules.footnote_caption=r,e.renderer.rules.footnote_anchor_name=t,e.block.ruler.before("reference","footnote_def",function(e,o,n,t){var r,s,f,l,i,u,a,c,p,d,h,k=e.bMarks[o]+e.tShift[o],b=e.eMarks[o];if(b<k+4)return!1;if(91!==e.src.charCodeAt(k))return!1;if(94!==e.src.charCodeAt(k+1))return!1;for(i=k+2;i<b;i++){if(32===e.src.charCodeAt(i))return!1;if(93===e.src.charCodeAt(i))break}if(i===k+2)return!1;if(b<=i+1||58!==e.src.charCodeAt(++i))return!1;if(t)return!0;for(i++,e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.refs||(e.env.footnotes.refs={}),u=e.src.slice(k+2,i-2),e.env.footnotes.refs[":"+u]=-1,(a=new e.Token("footnote_reference_open","",1)).meta={label:u},a.level=e.level++,e.tokens.push(a),r=e.bMarks[o],s=e.tShift[o],f=e.sCount[o],l=e.parentType,h=i,c=p=e.sCount[o]+i-(e.bMarks[o]+e.tShift[o]);i<b&&(d=e.src.charCodeAt(i),v(d));)9===d?p+=4-p%4:p++,i++;return e.tShift[o]=i-h,e.sCount[o]=p-c,e.bMarks[o]=h,e.blkIndent+=4,e.parentType="footnote",e.sCount[o]<e.blkIndent&&(e.sCount[o]+=e.blkIndent),e.md.block.tokenize(e,o,n,!0),e.parentType=l,e.blkIndent-=4,e.tShift[o]=s,e.sCount[o]=f,e.bMarks[o]=r,(a=new e.Token("footnote_reference_close","",-1)).level=--e.level,e.tokens.push(a),!0},{alt:["paragraph","reference"]}),e.inline.ruler.after("image","footnote_inline",function(e,o){var n,t,r,s,f=e.posMax,l=e.pos;return!(f<=l+2||94!==e.src.charCodeAt(l)||91!==e.src.charCodeAt(l+1)||(n=l+2,(t=i(e,l+1))<0||(o||(e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.list||(e.env.footnotes.list=[]),r=e.env.footnotes.list.length,e.md.inline.parse(e.src.slice(n,t),e.md,e.env,s=[]),e.push("footnote_ref","",0).meta={id:r},e.env.footnotes.list[r]={tokens:s}),e.pos=t+1,e.posMax=f,0)))}),e.inline.ruler.after("footnote_inline","footnote_ref",function(e,o){var n,t,r,s,f=e.posMax,l=e.pos;if(f<l+3)return!1;if(!e.env.footnotes||!e.env.footnotes.refs)return!1;if(91!==e.src.charCodeAt(l))return!1;if(94!==e.src.charCodeAt(l+1))return!1;for(t=l+2;t<f;t++){if(32===e.src.charCodeAt(t))return!1;if(10===e.src.charCodeAt(t))return!1;if(93===e.src.charCodeAt(t))break}return!(t===l+2||f<=t||(t++,n=e.src.slice(l+2,t-1),void 0===e.env.footnotes.refs[":"+n]||(o||(e.env.footnotes.list||(e.env.footnotes.list=[]),e.env.footnotes.refs[":"+n]<0?(r=e.env.footnotes.list.length,e.env.footnotes.list[r]={label:n,count:0},e.env.footnotes.refs[":"+n]=r):r=e.env.footnotes.refs[":"+n],s=e.env.footnotes.list[r].count,e.env.footnotes.list[r].count++,e.push("footnote_ref","",0).meta={id:r,subId:s,label:n}),e.pos=t,e.posMax=f,0)))}),e.core.ruler.after("inline","footnote_tail",function(e){var o,n,t,r,s,f,l,i,u,a,c=!1,p={};if(e.env.footnotes&&(e.tokens=e.tokens.filter(function(e){return"footnote_reference_open"===e.type?(c=!0,u=[],a=e.meta.label,!1):"footnote_reference_close"===e.type?(c=!1,p[":"+a]=u,!1):(c&&u.push(e),!c)}),e.env.footnotes.list)){for(f=e.env.footnotes.list,l=new e.Token("footnote_block_open","",1),e.tokens.push(l),o=0,n=f.length;o<n;o++){for((l=new e.Token("footnote_open","",1)).meta={id:o,label:f[o].label},e.tokens.push(l),f[o].tokens?(i=[],(l=new e.Token("paragraph_open","p",1)).block=!0,i.push(l),(l=new e.Token("inline","",0)).children=f[o].tokens,l.content="",i.push(l),(l=new e.Token("paragraph_close","p",-1)).block=!0,i.push(l)):f[o].label&&(i=p[":"+f[o].label]),e.tokens=e.tokens.concat(i),s="paragraph_close"===e.tokens[e.tokens.length-1].type?e.tokens.pop():null,r=0<f[o].count?f[o].count:1,t=0;t<r;t++)(l=new e.Token("footnote_anchor","",0)).meta={id:o,subId:t,label:f[o].label},e.tokens.push(l);s&&e.tokens.push(s),l=new e.Token("footnote_close","",-1),e.tokens.push(l)}l=new e.Token("footnote_block_close","",-1),e.tokens.push(l)}})}},{}]},{},[1])(1)});
